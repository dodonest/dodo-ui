import{q as X,v as W,m as y,w as Y,x as G,y as J,z as Z,I as H,A as K,B,C as V,D as $,E as z,F as N,G as j,H as ee,J as re,K as ae,M as ne,O as R,P as ie,i as le,Q as P,R as fe}from"./context-DSyyeuqi.js";import{q as ue}from"./props-HMLaVAqX.js";let ve=!1;function te(l,e,r,v){for(var s=[],d=e.length,_=0;_<d;_++)j(e[_].e,s,!0);var c=d>0&&s.length===0&&r!==null;if(c){var h=r.parentNode;ee(h),h.append(r),v.clear(),A(l,e[0].prev,e[d-1].next)}re(s,()=>{for(var o=0;o<d;o++){var t=e[o];c||(v.delete(t.k),A(l,t.prev,t.next)),ae(t.e,!c)}})}function he(l,e,r,v,s,d=null){var _=l,c={flags:e,items:new Map,first:null},h=(e&P)!==0;if(h){var o=l;_=o.appendChild(X())}var t=null,x=!1,n=Y(()=>{var u=r();return le(u)?u:u==null?[]:K(u)});W(()=>{var u=y(n),a=u.length;x&&a===0||(x=a===0,se(u,c,_,s,e,v,r),d!==null&&(a===0?t?G(t):t=J(()=>d(_)):t!==null&&Z(t,()=>{t=null})),y(n))})}function se(l,e,r,v,s,d,_){var b,q,D,L;var c=(s&fe)!==0,h=(s&(R|N))!==0,o=l.length,t=e.items,x=e.first,n=x,u,a=null,T,p=[],E=[],C,I,i,f;if(c)for(f=0;f<o;f+=1)C=l[f],I=d(C,f),i=t.get(I),i!==void 0&&((b=i.a)==null||b.measure(),(T??(T=new Set)).add(i));for(f=0;f<o;f+=1){if(C=l[f],I=d(C,f),i=t.get(I),i===void 0){var Q=n?n.e.nodes_start:r;a=_e(Q,e,a,a===null?e.first:a.next,C,I,f,v,s,_),t.set(I,a),p=[],E=[],n=a.next;continue}if(h&&de(i,C,f,s),(i.e.f&H)!==0&&(G(i.e),c&&((q=i.a)==null||q.unfix(),(T??(T=new Set)).delete(i))),i!==n){if(u!==void 0&&u.has(i)){if(p.length<E.length){var g=E[0],m;a=g.prev;var S=p[0],M=p[p.length-1];for(m=0;m<p.length;m+=1)F(p[m],g,r);for(m=0;m<E.length;m+=1)u.delete(E[m]);A(e,S.prev,M.next),A(e,a,S),A(e,M,g),n=g,a=M,f-=1,p=[],E=[]}else u.delete(i),F(i,n,r),A(e,i.prev,i.next),A(e,i,a===null?e.first:a.next),A(e,a,i),a=i;continue}for(p=[],E=[];n!==null&&n.k!==I;)(n.e.f&H)===0&&(u??(u=new Set)).add(n),E.push(n),n=n.next;if(n===null)continue;i=n}p.push(i),a=i,n=i.next}if(n!==null||u!==void 0){for(var w=u===void 0?[]:K(u);n!==null;)(n.e.f&H)===0&&w.push(n),n=n.next;var k=w.length;if(k>0){var U=(s&P)!==0&&o===0?r:null;if(c){for(f=0;f<k;f+=1)(D=w[f].a)==null||D.measure();for(f=0;f<k;f+=1)(L=w[f].a)==null||L.fix()}te(e,w,U,t)}}c&&ue(()=>{var O;if(T!==void 0)for(i of T)(O=i.a)==null||O.apply()}),B.first=e.first&&e.first.e,B.last=a&&a.e}function de(l,e,r,v){(v&R)!==0&&V(l.v,e),(v&N)!==0?V(l.i,r):l.i=r}function _e(l,e,r,v,s,d,_,c,h,o){var t=(h&R)!==0,x=(h&ie)===0,n=t?x?$(s):z(s):s,u=(h&N)===0?_:z(_),a={i:u,v:n,k:d,a:null,e:null,prev:r,next:v};try{return a.e=J(()=>c(l,n,u,o),ve),a.e.prev=r&&r.e,a.e.next=v&&v.e,r===null?e.first=a:(r.next=a,r.e.next=a.e),v!==null&&(v.prev=a,v.e.prev=a.e),a}finally{}}function F(l,e,r){for(var v=l.next?l.next.e.nodes_start:r,s=e?e.e.nodes_start:r,d=l.e.nodes_start;d!==v;){var _=ne(d);s.before(d),d=_}}function A(l,e,r){e===null?l.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}export{he as e};
